!function(t){"use strict";function i(){t(this).removeClass("range-slider"),t(this).data("range-slider",void 0),t(this).init.prototype.range=void 0,t("*",this).remove()}function n(){t(this).rangeSlider("destroy"),t(this).rangeSlider()}function a(t){var i=Array.prototype.slice.call(arguments);return e[t].apply(this,i)}var e=Object();e.type=function(i,n){var a=t(this).attr("data-type");if(n){var a=n;return"vertical"!=a&&(a="horizontal"),t(this).attr("data-type",a),a}var a=t(this).attr("data-type");return"vertical"!=a&&(a="horizontal",t(this).attr("data-type",a)),a},e.step=function(i,n,a){var e;if(n)return e=Number(n),isNaN(e)&&(e=1),t(this).attr("data-step",e),e;var r=t(this).attr("data-step");try{e=t.parseJSON(r)}catch(i){e=Number(r),isNaN(e)&&(e=1),t(this).attr("data-step",e)}if(Array.isArray(e)){var o=r;t(this).attr("save_jason",o);var e=0;if(t(this).attr("data-step")){for(var d=JSON.parse(t(this).attr("data-step")),s=0;s<d.length;s++){var m=d[s],l=parseInt(m.start),p=parseInt(m.end),h=parseInt(m.step);e+=(p-l)/h}var u=t(this).rangeSlider("option","unit");t(this).attr("data-step",u/e)}}return e},e.min=function(i,n){if(n){var a=n;return isNaN(a)&&(a=0),t(this).attr("data-min",a),a}var a=parseInt(t(this).attr("data-min"));return isNaN(a)&&(a=0,t(this).attr("data-min",a)),a},e.max=function(i,n){var a=parseInt(t(this).attr("data-min"));if(n){var e=n;return(isNaN(e)||a>=e)&&(e=a+100),t(this).attr("data-max",e),e}var e=parseInt(t(this).attr("data-max"));return(isNaN(e)||a>=e)&&(e=a+100,t(this).attr("data-max",e)),e},e.min_unit=function(i,n){if(n){var a=n;return isNaN(a)&&(a=0),t(this).attr("data-min-unit",a),a}var a=Number(t(this).attr("data-min-unit"));return isNaN(a)&&(a=0,t(this).attr("data-min-unit",a)),a},e.unit=function(i,n){var a,e=Number(t(this).attr("data-max")),r=Number(t(this).attr("data-min")),a=e-r;return a},e.min_title=function(i,n){var a=t(this).attr("data-min-title");if(n){var a=n;t(this).attr("data-min-title",a)}return a},e.max_title=function(i,n){var a=t(this).attr("data-show-title");if(n){var a=n;t(this).attr("data-show-title",a)}},e.max_limit=function(i,n){var a;if(a=parseInt(t(this).attr("data-max-limit")),n&&(a=parseInt(n)),isNaN(a)&&(a=void 0),n){a?t(this).attr("data-max-limit",a):t(this).removeAttr("data-max-limit");var e=a-t(this).rangeSlider("option","min"),r=100*e/t(this).rangeSlider("option","unit"),o="vertical"==t(this).rangeSlider("option","type")?"top":"left";t(".max_limit",this).length||t(this).append("<div class='max_limit'></div>"),"top"==o?t(this).find(".max_limit").css("top",100-r+"%"):t(this).find(".max_limit").css("left",r+"%")}return a},e.min_default=function(i,n){t(this).parents("range-slider");if("min"!=t(this).attr("data-infinity")){var a=parseInt(t(this).attr("data-min"));if(n){var e=n;return(isNaN(e)||a>e)&&(e=0),t(this).attr("data-min-default",e),e}var e=Number(t(this).attr("data-min-default"));return(isNaN(e)||a>e)&&(e=0,t(this).attr("data-min-default",e)),e}return 0},e.max_default=function(i,n){if("max"!=t(this).attr("data-infinity")){var a=Number(t(this).attr("data-max")),e=Number(t(this).attr("data-min")),r=a-e;if(n){var o=n;return(isNaN(o)||a<o)&&(o=r),t(this).attr("data-max-default",o),o}var o=Number(t(this).attr("data-max-default"));return(isNaN(o)||a<o)&&(o=r,t(this).attr("data-max-default",o)),o}return t(this).rangeSlider("option","max")},e.margin=function(i,n){var a="vertical"==t(this).rangeSlider("option","type")?"height":"width",e=parseInt(t(this).find(".dynamic-margin").css(a));return e},e.depth=function(i,n){var a=Number(t(this).attr("data-max")),e=a;return e},e.unit_to_pixel=function(i,n){var a=t(this).rangeSlider("option","max")-t(this).rangeSlider("option","min"),e="vertical"==t(this).rangeSlider("option","type")?"height":"width",r=parseInt(t(this).css(e)),o=parseInt(n*r/a);return o},e.range_width=function(i,n){var a="vertical"==t(this).rangeSlider("option","type")?"height":"width",e=parseInt(t(this).find(".dynamic-range").css(a));return e},e.total_width=function(i,n){var a="vertical"==t(this).rangeSlider("option","type")?"height":"width",e=parseInt(t(this).css(a));return e},e.range=function(i,n,a,e){if(null==e){if("from"==n)return t(this).rangeSlider("option","margin");if("to"==n)return t(this).rangeSlider("option","margin")+t(this).rangeSlider("option","range_width")}return"to"==n?t(this).range(null,e,a):"from"==n?"min"!=t(this).attr("data-infinity")&&t(this).range(e,null,a):void 0},t.fn.rangeSlider=function(e){var o=Array.prototype.slice.call(arguments);switch(e){case"destroy":return i.call(this);case"restart":return n.call(this);case"option":return a.apply(this,o.splice(1))}t(this).each(function(){t(this).hasClass("range-slider")&&t(this).rangeSlider("destroy"),t(this).trigger("range-slider::init::before"),t(this).addClass("range-slider");var i=t(this).attr("id");i&&(t('<input type="hidden" name="'+i+'-max" data-range-bind="'+i+'" data-range-value="max">').appendTo(this),t('<input type="hidden" name="'+i+'-min" data-range-bind="'+i+'" data-range-value="min">').appendTo(this));var n=t(this).attr("data-infinity");t(this).rangeSlider("option","type",t(this).attr("data-type")),t(this).rangeSlider("option","min",t(this).attr("data-min")),t(this).rangeSlider("option","max",t(this).attr("data-max")),t(this).rangeSlider("option","unit",t(this).attr("data-unit")),t(this).rangeSlider("option","min_default",t(this).attr("data-min-default")),t(this).rangeSlider("option","max_default",t(this).attr("data-max-default")),t(this).data("range-slider",{}),t(this).init.prototype.range=function(i,n,a){var e=i,r=n,o=t(this).data("range-slider");o.type=this.rangeSlider("option","type"),o.step=this.rangeSlider("option","step"),o.min=this.rangeSlider("option","min"),o.max=this.rangeSlider("option","max"),o.unit=this.rangeSlider("option","unit"),o.min_default=this.rangeSlider("option","min_default"),o.max_default=this.rangeSlider("option","max_default"),o.margin=this.rangeSlider("option","margin"),o.depth=this.rangeSlider("option","depth"),o.min_unit=this.rangeSlider("option","min_unit"),o.min_title=this.rangeSlider("option","min_title"),o.max_title=this.rangeSlider("option","max_title"),o.max_limit=this.rangeSlider("option","max_limit"),o.unit_to_pixel=this.rangeSlider("option","unit_to_pixel"),o.range_width=this.rangeSlider("option","range_width"),o.total_width=this.rangeSlider("option","total_width");var d={type:"unit"};t.extend(d,a),d.from_type=d.type,d.to_type=d.type;var s="vertical"==o.type?"height":"width";null!==e&&e!==!1&&void 0!==e||(e=this.find(".dynamic-margin")[s](),"vertical"==t(this).rangeSlider("option","type")&&(e=this[s]()-(e+this.find(".dynamic-range")[s]())),d.from_type="pixel"),null!==r&&r!==!1&&void 0!==r||(r=this.find(".dynamic-margin")[s]()+this.find(".dynamic-range")[s](),"vertical"==t(this).rangeSlider("option","type")&&(r=this[s]()-this.find(".dynamic-margin")[s]()),d.to_type="pixel");var m=this[s]();"pixel"==d.from_type?e=e*t(this).rangeSlider("option","unit")/m:"percent"==d.from_type?e=e*t(this).rangeSlider("option","unit")/100:"ziro_unit"==d.from_type?e-=t(this).rangeSlider("option","min"):"step_plus"==d.from_type&&(e=e*t(this).rangeSlider("option","step")+o.from),"pixel"==d.to_type?r=r*t(this).rangeSlider("option","unit")/m:"percent"==d.to_type?r=r*t(this).rangeSlider("option","unit")/100:"ziro_unit"==d.to_type?r-=t(this).rangeSlider("option","min"):"step_plus"==d.to_type&&(r=r*t(this).rangeSlider("option","step")+o.to);var l=Math.round(e/t(this).rangeSlider("option","step"))*t(this).rangeSlider("option","step"),p=Math.round(r/t(this).rangeSlider("option","step"))*t(this).rangeSlider("option","step");p>o.max_limit-o.min&&(p=o.max_limit-o.min),p>o.max_limit-o.min&&(p=o.max_limit-o.min),l>o.max_limit-o.min-o.min_unit&&(l=o.max_limit-o.min-o.min_unit),p<l&&(o.to==p?p=l:l=p),p>o.unit&&(p=o.unit),l>o.unit&&(l=o.unit),p<0&&(p=0),l<0&&(l=0),t(this).attr("data-max-limit")&&t(this).rangeSlider("option","max_limit",t(this).attr("data-max-limit"));var h=t(this).rangeSlider("option","min_unit");t(this).find(".dynamic-range .min .mount").attr("data-value-show",parseInt(o.min+l)),t(this).find(".dynamic-range .max .mount").attr("data-value-show",parseInt(o.min+p)),p-l<=h&&(t(this).find(".dynamic-range .max .mount").attr("data-value-show",h+o.min+l),t(this).find(".dynamic-range .min .mount").attr("data-value-show",p-h+o.min),p<=h+l&&(null==i?l=p-h:null==n&&(p=l+h),p>=t(this).rangeSlider("option","unit")&&(p=t(this).rangeSlider("option","unit"),l=t(this).rangeSlider("option","unit")-h)),l<=o.min&&t(this).find(".dynamic-range .min .mount").attr("data-value-show",o.min));var u=t(this).attr("save_jason"),g=[],c=[],f=[];if(u){for(var v=jQuery.parseJSON(u),y=0;y<v.length;y++){var x=v[y],S=parseInt(x.start),_=parseInt(x.end),b=parseInt(x.step);g.push(b),c.push(S),f.push(_);var w=Math.round(l/t(this).rangeSlider("option","step")),N=Math.round(p/t(this).rangeSlider("option","step"))}for(var I=[],C=0,k=0;k<c.length;k++)C+=(f[k]-c[k])/g[k],I.push(C);for(var y=0;y<I.length;y++)if(N<=I[y]){if(isNaN(N-I[y-1]))var T=N;else var T=N-I[y-1];var A=c[y]+T*g[y];break}for(var y=0;y<I.length;y++)if(w<=I[y]){if(isNaN(w-I[y-1]))var T=w;else var T=w-I[y-1];var E=c[y]+T*g[y];break}t(this).find(".dynamic-range .min .mount").attr("data-value-show",parseInt(E)),t(this).find(".dynamic-range .max .mount").attr("data-value-show",parseInt(A))}if(null==i)var X="max",Y=t(this).find(".dynamic-range .max .mount").attr("data-value-show");else if(null==n)var X="min",Y=t(this).find(".dynamic-range .min .mount").attr("data-value-show");var j,O=t(this).attr("data-show-title");try{j=t.parseJSON(O)}catch(t){j=O}if(Array.isArray(j))for(var y=j.length-1;y>=0;y--){var z=j[y];for(var D in z)"min"==D?D=o.min:"max"==D&&(D=o.max),Y==D&&(D==o.min?D="min":D==o.max&&(D="max"),"min"==X?t(this).find(".dynamic-range .min .mount").attr("data-value-show",z[D]):"max"==X&&t(this).find(".dynamic-range .max .mount").attr("data-value-show",z[D]))}var J=this.attr("id");J&&t('[data-range-bind="'+J+'"]').each(function(){var i=t(this).attr("data-range-value");"max"==i?t(this).val(o.min+p):"min"==i&&t(this).val(o.min+l)}),e=100*l/t(this).rangeSlider("option","unit"),r=100*p/t(this).rangeSlider("option","unit");var M=r-e;o.to==p&&o.from==l||(this.data("range-slider").from=l,this.data("range-slider").to=p,this.trigger("range-slider::change::before",[o.min+l,o.min+p]),"vertical"==o.type?this.find(".dynamic-margin").css(s,100-r+"%"):this.find(".dynamic-margin").css(s,e+"%"),this.find(".dynamic-range").css(s,M+"%"),this.trigger("range-slider::change",[o.min+l,o.min+p]))};var a=t("<div class='dynamic-margin'></div>"),e=t("<div class='dynamic-range'></div>");"max"==n?r.call(this,"min").appendTo(e):"min"==n?r.call(this,"max").appendTo(e):(r.call(this,"max").appendTo(e),r.call(this,"min").appendTo(e)),e.find("div.min, div.max").append("<span class='mount'></span>");var o=e.find("div.min span.mount, div.max span.mount");t(this).find(".dynamic-range span.mount").show();var d=t(this).attr("data-fix-mount");o.hide(),"on"==d&&(o.show(),t(this).addClass("margin-range")),a.hide(),e.hide(),a.appendTo(this),e.appendTo(this),"max"==t(this).attr("data-infinity")?t(this).range(t(this).rangeSlider("option","min_default")-t(this).rangeSlider("option","min"),t(this).rangeSlider("option","max")):t(this).range(t(this).rangeSlider("option","min_default"),t(this).rangeSlider("option","max_default")),r.call(this,"min"),a.show(),e.show(),t(this).trigger("range-slider::init::after")})};var r=function(i){t(this).attr("data-infinity")||(t(this).unbind("mousemove.dynamic-range"),t(this).bind("mousemove.dynamic-range",function(){var i=t(this).find(".dynamic-range");t(i).bind("mousedown.dynamic-range",function(){var i=t(this).parents(".range-slider"),e="vertical"==a.type?event.pageY:event.pageX,r="vertical"==a.type?t(i).offset().top:t(i).offset().left,o=e-r,d=t(i).rangeSlider("option","range_width"),s=t(i).rangeSlider("option","margin");t(i).rangeSlider("option","range","to",{type:"pixel"}),t(i).rangeSlider("option","range","from",{type:"pixel"});return t(document).unbind("mousemove.dynamic-range"),t(document).bind("mousemove.dynamic-range",function(n){t(i).find(".dynamic-range div.min , .dynamic-range div.max").addClass("active"),t(i).find(".dynamic-range span.mount").show();var e="vertical"==a.type?n.pageY:n.pageX,r="vertical"==a.type?t(i).offset().top:t(i).offset().left,m=e-r;m="vertical"==a.type?t(i).height()-m:m;var l=m-o,p=t(i).rangeSlider("option","max_limit")-t(i).rangeSlider("option","min"),h=t(i).rangeSlider("option","unit_to_pixel",p),u=s+l,g=d+s+l;g>=h?u=h-d:u<=0&&(g=d),t(i).rangeSlider("option","range","to",{type:"pixel"},g),t(i).rangeSlider("option","range","from",{type:"pixel"},u)}).bind("mouseup.dynamic-range",function(){t(i).find(".dynamic-range div.min , .dynamic-range div.max").removeClass("active"),"on"!=n&&t(i).find(".dynamic-range span.mount").hide(),t(document).unbind("mouseup.dynamic-range"),t(document).unbind("mousemove.dynamic-range")}),!1}).bind("mouseup",function(){t(i).unbind("mousedown.dynamic-range")})}),t(document).unbind("touchend"),t(document).unbind("touchstart"),t(document).unbind("touchmove.dynamic-range"),t(this).bind("touchstart",function(i){i.preventDefault();var n=t(event.target),e=t(this);if(n.is(".dynamic-range")){var r="vertical"==a.type?i.originalEvent.touches[0].pageY:i.originalEvent.touches[0].pageX,o="vertical"==a.type?t(e).offset().top:t(e).offset().left,d=r-o,s=t(e).rangeSlider("option","range_width"),m=t(e).rangeSlider("option","margin");t(e).rangeSlider("option","range","to",{type:"pixel"}),t(e).rangeSlider("option","range","from",{type:"pixel"})}t(document).unbind("touchmove.dynamic-range"),t(document).bind("touchmove.dynamic-range",function(i){i.preventDefault();var n=t(event.target);if(n.is(".dynamic-range")){t(e).find(".dynamic-range div.min , .dynamic-range div.max").addClass("active"),t(e).find(".dynamic-range span.mount").show();var r="vertical"==a.type?i.originalEvent.touches[0].pageY:i.originalEvent.touches[0].pageX,o="vertical"==a.type?t(e).offset().top:t(e).offset().left,l=r-o;l="vertical"==a.type?t(e).height()-l:l;var p=l-d,h=t(e).rangeSlider("option","max_limit")-t(e).rangeSlider("option","min"),u=t(e).rangeSlider("option","unit_to_pixel",h),g=m+p,c=s+m+p;c>=u?g=u-s:g<=0&&(c=s),t(e).rangeSlider("option","range","to",{type:"pixel"},c),t(e).rangeSlider("option","range","from",{type:"pixel"},g)}})}).bind("touchend.dynamic-range",function(i){t(e).find(".dynamic-range div.min , .dynamic-range div.max").removeClass("active"),"on"!=n&&t(e).find(".dynamic-range span.mount").hide(),t(document).unbind("touchend"),t(document).unbind("touchstart"),t(document).unbind("touchmove")}));var n=t(this).attr("data-fix-mount"),a=t(this).data("range-slider"),e=this,r=t("<div class='"+i+"'></div>");return t(this).trigger("range-slider::selection",[r,i]),r.attr("tabindex","0"),r.unbind("mousedown.range-slider"),r.bind("mousedown.range-slider",function(){return t(document).unbind("mousemove.range-slider"),t(document).bind("mousemove.range-slider",function(r){t(e).find(".dynamic-range ."+i).addClass("active"),"on"!=n&&t(e).find(".dynamic-range ."+i+" span.mount").show();var o="vertical"==a.type?r.pageY:r.pageX,d="vertical"==a.type?t(e).offset().top:t(e).offset().left,s=o-d;s="vertical"==a.type?t(e).height()-s:s,"max"==i?t(e).rangeSlider("option","range","to",{type:"pixel"},s):t(e).rangeSlider("option","range","from",{type:"pixel"},s)}).bind("mouseup.range-slider",function(){t(e).find(".dynamic-range ."+i).removeClass("active"),"on"!=n&&t(e).find(".dynamic-range ."+i+" span.mount").hide(),t(document).unbind("mouseup.range-slider"),t(document).unbind("mousemove.range-slider")}),!1}).bind("mouseup",function(){t(document).unbind("mousemove.range-slider")}).bind("keydown.range-slider",function(i){if(a=1,i.shiftKey)var a=5;if(t(this).is(".max")){if("on"!=n&&t(e).find(".dynamic-range .max span.mount").show(),38==i.keyCode||39==i.keyCode)return t(this).parents(".range-slider").rangeSlider("option","range","to",{type:"step_plus"},a),!1;if(37==i.keyCode||40==i.keyCode)return t(this).parents(".range-slider").rangeSlider("option","range","to",{type:"step_plus"},-a),!1}else{if(t(e).find(".dynamic-range .min span.mount").show(),38==i.keyCode||39==i.keyCode)return t(this).parents(".range-slider").rangeSlider("option","range","from",{type:"step_plus"},a),!1;if(37==i.keyCode||40==i.keyCode)return t(this).parents(".range-slider").rangeSlider("option","range","from",{type:"step_plus"},-a),!1}"on"!=n&&(t(e).find(".dynamic-range .max span.mount").hide(),t(e).find(".dynamic-range .min span.mount").hide())}).bind("touchmove",function(r){r.preventDefault(),t(e).find(".dynamic-range ."+i).addClass("active"),"on"!=n&&t(e).find(".dynamic-range ."+i+" span.mount").show();var o="vertical"==a.type?r.originalEvent.touches[0].pageY:r.originalEvent.touches[0].pageX,d="vertical"==a.type?t(e).offset().top:t(e).offset().left,s=o-d;s="vertical"==a.type?t(e).height()-s:s,"max"==i?t(e).rangeSlider("option","range","to",{type:"pixel"},s):t(e).rangeSlider("option","range","from",{type:"pixel"},s)}).bind("touchend",function(a){a.preventDefault(),t(e).find(".dynamic-range ."+i).removeClass("active"),"on"!=n&&t(e).find(".dynamic-range ."+i+" span.mount").hide(),t(document).unbind("mouseup.range-slider"),t(document).unbind("mousemove.range-slider")}),r}}(jQuery);